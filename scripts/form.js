document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("#request-form, #event-form").forEach((e=>{const t=e.querySelector(".form__checkbox-img");t.addEventListener("click",(e=>{e.preventDefault(),t.classList.toggle("checked")}));t.parentElement.addEventListener("click",(e=>{"A"!==e.target.tagName&&"BUTTON"!==e.target.tagName&&(e.preventDefault(),t.click())}));const n=e.querySelector('input[name="name"]'),a=e.querySelector('input[name="email"]'),c=e.querySelector('input[name="company"]'),r=e.querySelector('input[name="privacy-consent"]'),s=e.closest(".main__form-body"),o=s.querySelector(".main__form-errors"),i=s.nextElementSibling,l=i&&i.classList.contains("main__form-done")?i:null,d=e.querySelector("#form-button, #event__form-button")||e.querySelector('button[type="submit"]');function u(){const s=[];return n.value.trim()||s.push({text:"full name",input:n}),e.dataset.company||c?.value.trim()||s.push({text:"company name",input:c}),a.value.trim()||s.push({text:"work email",input:a}),r.checked||t.classList.contains("checked")||s.push({text:"consent",input:t}),o.querySelectorAll("a").forEach((e=>e.remove())),s.forEach(((e,t)=>{const n=document.createElement("a");n.classList.add("form__underlined"),n.href="#",n.textContent=e.text+(t<s.length-1?",":"."),n.addEventListener("click",(t=>{t.preventDefault(),e.input.focus()})),o.appendChild(n)})),s.length?o.classList.add("has-errors"):o.classList.remove("has-errors"),0===s.length}e.addEventListener("submit",(async o=>{if(o.preventDefault(),u()){const o={name:n.value,email:a.value,company:(e.dataset.company||c?.value||"").trim(),consent:t.classList.contains("checked"),fakeConsent:r.checked};d.disabled=!0;try{await fetch("https://ibf9nq7m2d.execute-api.eu-central-1.amazonaws.com/prod/connect",{method:"POST",body:JSON.stringify(o)}),s.classList.add("done"),l&&l.classList.add("done"),e.reset(),t.classList.remove("checked")}finally{d.disabled=!1}}else[n,a,c,r].forEach((e=>{e.addEventListener("input",(()=>{u()}))})),t.addEventListener("click",(()=>{u()}))}))}))}));